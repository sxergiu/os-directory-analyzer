#!/bin/bash


if [ $# -ne 1 ]; then
    echo "Usage: $0 <file_path>"
    exit 1
fi

file_path=$1
file_name=$(basename "$file_path")


if [ ! -f "$file_path" ]; then
    echo "Error: File '$file_path' not found."
    exit 1
fi

chmod +r "$file_path"
num_lines=$(wc -l < "$file_path")
num_words=$(wc -w < "$file_path")
num_chars=$(wc -m < "$file_path")

if [ "$num_lines" -lt 3 ] && [ "$num_words" -gt 1000 ] && [ "$num_chars" -gt 2000 ]; then
    echo "$file_name"
	chmod -r "$file_path"
	exit 0
fi


if grep -qP '[^\x00-\x7F]' "$file_path"; then
    echo "$file_name"
	chmod -r "$file_path"
	exit 0
fi


search_words=("corrupted" "danger" "malware" "malicious" "dangerous")

for word in "${search_words[@]}"; do
    if grep -qi "$word" "$file_path"; then
        echo "$file_name"
	    chmod -r "$file_path"
	    exit 0
    fi
done

echo "SAFE"
chmod -r "$file_path"
exit 0

